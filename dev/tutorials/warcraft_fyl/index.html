<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Training on Warcraft Shortest Path · DecisionFocusedLearningAlgorithms.jl</title><meta name="title" content="Training on Warcraft Shortest Path · DecisionFocusedLearningAlgorithms.jl"/><meta property="og:title" content="Training on Warcraft Shortest Path · DecisionFocusedLearningAlgorithms.jl"/><meta property="twitter:title" content="Training on Warcraft Shortest Path · DecisionFocusedLearningAlgorithms.jl"/><meta name="description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><meta property="og:description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><meta property="twitter:description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">DecisionFocusedLearningAlgorithms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../interface/">Interface Guide</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorial/">Basic Tutorial: Training with FYL on Argmax Benchmark</a></li><li class="is-active"><a class="tocitem" href>Training on Warcraft Shortest Path</a><ul class="internal"><li><a class="tocitem" href="#Setup"><span>Setup</span></a></li><li><a class="tocitem" href="#Benchmark-Setup"><span>Benchmark Setup</span></a></li><li><a class="tocitem" href="#Creating-a-Policy"><span>Creating a Policy</span></a></li><li><a class="tocitem" href="#Configuring-the-Algorithm"><span>Configuring the Algorithm</span></a></li><li><a class="tocitem" href="#Setting-Up-Metrics"><span>Setting Up Metrics</span></a></li><li><a class="tocitem" href="#Training"><span>Training</span></a></li><li><a class="tocitem" href="#Results-Analysis"><span>Results Analysis</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../api/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Tutorials</a></li><li class="is-active"><a href>Training on Warcraft Shortest Path</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Training on Warcraft Shortest Path</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/main/docs/src/tutorials/warcraft_fyl.jl" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Training-on-Warcraft-Shortest-Path"><a class="docs-heading-anchor" href="#Training-on-Warcraft-Shortest-Path">Training on Warcraft Shortest Path</a><a id="Training-on-Warcraft-Shortest-Path-1"></a><a class="docs-heading-anchor-permalink" href="#Training-on-Warcraft-Shortest-Path" title="Permalink"></a></h1><p>This tutorial demonstrates how to train a decision-focused learning policy on the Warcraft shortest path benchmark using the Perturbed Fenchel-Young Loss Imitation algorithm.</p><h2 id="Setup"><a class="docs-heading-anchor" href="#Setup">Setup</a><a id="Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Setup" title="Permalink"></a></h2><p>First, let&#39;s load the required packages:</p><pre><code class="language-julia hljs">using DecisionFocusedLearningAlgorithms
using DecisionFocusedLearningBenchmarks
using Flux
using MLUtils
using Plots
using Statistics</code></pre><h2 id="Benchmark-Setup"><a class="docs-heading-anchor" href="#Benchmark-Setup">Benchmark Setup</a><a id="Benchmark-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Benchmark-Setup" title="Permalink"></a></h2><p>The Warcraft benchmark involves predicting edge costs in a grid graph for shortest path problems. We&#39;ll create a benchmark instance and generate training data:</p><pre><code class="language-julia hljs">benchmark = WarcraftBenchmark()
dataset = generate_dataset(benchmark, 50)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">50-element Vector{DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}}:
 DataSample(x=Float32[0.133333 0.133333 … 0.164706 0.235294; 0.12549 0.105882 … 0.168627 0.313726; … ; 0.247059 0.247059 … 0.0196078 0.0156863; 0.384314 0.423529 … 0.0156863 0.0196078;;; 0.309804 0.294118 … 0.341176 0.356863; 0.298039 0.282353 … 0.329412 0.254902; … ; 0.305882 0.266667 … 0.227451 0.219608; 0.239216 0.239216 … 0.219608 0.227451;;; 0.0392157 0.027451 … 0.0509804 0.0705882; 0.0313726 0.0235294 … 0.0470588 0.0235294; … ; 0.0431373 0.027451 … 0.458824 0.454902; 0.00392157 0.0 … 0.454902 0.458824;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -0.8; -0.8 -0.8 … -1.2 -1.2; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.0196078 0.0196078 … 0.423529 0.411765; 0.0156863 0.0156863 … 0.427451 0.443137; … ; 0.0196078 0.0196078 … 0.439216 0.439216; 0.0196078 0.0196078 … 0.431373 0.435294;;; 0.219608 0.215686 … 0.25098 0.239216; 0.219608 0.207843 … 0.25098 0.258824; … ; 0.227451 0.227451 … 0.258824 0.258824; 0.231373 0.227451 … 0.254902 0.258824;;; 0.454902 0.447059 … 0.00784314 0.00392157; 0.454902 0.443137 … 0.00784314 0.0117647; … ; 0.458824 0.462745 … 0.00784314 0.00784314; 0.462745 0.458824 … 0.00392157 0.00784314;;;;], θ_true=Float16[-7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -1.2 -1.2; … ; -7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -9.2 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.223529 0.0 … 0.160784 0.164706; 0.203922 0.0588235 … 0.156863 0.156863; … ; 0.0235294 0.00392157 … 0.00392157 0.0235294; 0.0352941 0.0117647 … 0.0 0.0;;; 0.407843 0.25098 … 0.32549 0.337255; 0.356863 0.32549 … 0.321569 0.329412; … ; 0.196078 0.215686 … 0.207843 0.235294; 0.215686 0.196078 … 0.231373 0.247059;;; 0.0823529 0.0 … 0.0431373 0.0509804; 0.054902 0.0352941 … 0.0431373 0.0431373; … ; 0.0 0.0 … 0.0 0.00784314; 0.0196078 0.0 … 0.0 0.0;;;;], θ_true=Float16[-5.3 -5.3 … -1.2 -0.8; -5.3 -5.3 … -1.2 -0.8; … ; -5.3 -5.3 … -5.3 -5.3; -5.3 -5.3 … -5.3 -5.3], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.431373 0.454902 … 0.0156863 0.0196078; 0.411765 0.368627 … 0.0156863 0.0156863; … ; 0.14902 0.152941 … 0.152941 0.164706; 0.156863 0.137255 … 0.164706 0.164706;;; 0.25098 0.258824 … 0.219608 0.227451; 0.270588 0.278431 … 0.219608 0.219608; … ; 0.313726 0.321569 … 0.321569 0.333333; 0.32549 0.301961 … 0.333333 0.333333;;; 0.00392157 0.00784314 … 0.454902 0.462745; 0.0156863 0.0235294 … 0.454902 0.454902; … ; 0.0392157 0.0431373 … 0.0392157 0.0470588; 0.0431373 0.0313726 … 0.0470588 0.0470588;;;;], θ_true=Float16[-1.2 -7.7 … -7.7 -7.7; -7.7 -1.2 … -7.7 -7.7; … ; -0.8 -0.8 … -0.8 -5.3; -0.8 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.152941 0.317647 … 0.435294 0.403922; 0.376471 0.305882 … 0.431373 0.411765; … ; 0.2 0.121569 … 0.360784 0.411765; 0.0901961 0.172549 … 0.219608 0.447059;;; 0.152941 0.317647 … 0.258824 0.239216; 0.376471 0.305882 … 0.254902 0.243137; … ; 0.2 0.121569 … 0.223529 0.286275; 0.0901961 0.172549 … 0.164706 0.258824;;; 0.152941 0.317647 … 0.00784314 0.0; 0.376471 0.305882 … 0.00392157 0.0; … ; 0.2 0.121569 … 0.027451 0.109804; 0.0901961 0.172549 … 0.0862745 0.0;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -1.2; -9.2 -9.2 … -0.8 -1.2; … ; -9.2 -9.2 … -9.2 -1.2; -9.2 -9.2 … -9.2 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 0 1; 0 0 … 0 1])
 DataSample(x=Float32[0.0235294 0.0196078 … 0.164706 0.164706; 0.0156863 0.0156863 … 0.168627 0.164706; … ; 0.168627 0.164706 … 0.431373 0.427451; 0.156863 0.160784 … 0.431373 0.427451;;; 0.227451 0.223529 … 0.333333 0.329412; 0.215686 0.207843 … 0.337255 0.329412; … ; 0.337255 0.337255 … 0.254902 0.254902; 0.329412 0.317647 … 0.254902 0.254902;;; 0.458824 0.454902 … 0.0470588 0.0470588; 0.45098 0.443137 … 0.0470588 0.0470588; … ; 0.0470588 0.0470588 … 0.00392157 0.00392157; 0.0431373 0.0392157 … 0.00392157 0.00392157;;;;], θ_true=Float16[-7.7 -7.7 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8; … ; -1.2 -1.2 … -9.2 -9.2; -0.8 -1.2 … -9.2 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.407843 0.415686 … 0.380392 0.286275; 0.407843 0.411765 … 0.376471 0.309804; … ; 0.12549 0.113725 … 0.152941 0.160784; 0.129412 0.129412 … 0.156863 0.152941;;; 0.239216 0.243137 … 0.203922 0.278431; 0.239216 0.243137 … 0.278431 0.258824; … ; 0.298039 0.278431 … 0.317647 0.329412; 0.294118 0.298039 … 0.32549 0.333333;;; 0.00392157 0.00784314 … 0.0 0.0352941; 0.00392157 0.00392157 … 0.0235294 0.0235294; … ; 0.0313726 0.0196078 … 0.0392157 0.0470588; 0.027451 0.0313726 … 0.0431373 0.0470588;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -0.8 … -1.2 -1.2; … ; -0.8 -1.2 … -5.3 -5.3; -0.8 -0.8 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 0 0; 0 0 … 1 1])
 DataSample(x=Float32[0.0156863 0.0156863 … 0.439216 0.427451; 0.0156863 0.0156863 … 0.431373 0.435294; … ; 0.337255 0.364706 … 0.168627 0.196078; 0.262745 0.368627 … 0.227451 0.341176;;; 0.207843 0.2 … 0.258824 0.25098; 0.203922 0.207843 … 0.254902 0.254902; … ; 0.239216 0.27451 … 0.34902 0.376471; 0.317647 0.243137 … 0.360784 0.247059;;; 0.443137 0.435294 … 0.0117647 0.00784314; 0.439216 0.443137 … 0.00784314 0.00784314; … ; 0.0156863 0.0196078 … 0.054902 0.0784314; 0.0470588 0.0117647 … 0.0705882 0.0196078;;;;], θ_true=Float16[-7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -1.2; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.0235294 0.0196078 … 0.443137 0.439216; 0.0156863 0.0156863 … 0.435294 0.443137; … ; 0.396078 0.392157 … 0.439216 0.439216; 0.392157 0.392157 … 0.431373 0.435294;;; 0.235294 0.231373 … 0.258824 0.258824; 0.219608 0.215686 … 0.258824 0.258824; … ; 0.235294 0.231373 … 0.258824 0.258824; 0.231373 0.227451 … 0.254902 0.258824;;; 0.466667 0.462745 … 0.00784314 0.00784314; 0.454902 0.454902 … 0.00784314 0.00784314; … ; 0.0 0.0 … 0.00784314 0.00784314; 0.0 0.0 … 0.00392157 0.00784314;;;;], θ_true=Float16[-7.7 -7.7 … -7.7 -1.2; -7.7 -7.7 … -7.7 -1.2; … ; -1.2 -1.2 … -1.2 -9.2; -1.2 -1.2 … -1.2 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.0 0.0235294 … 0.4 0.392157; 0.0196078 0.00392157 … 0.392157 0.376471; … ; 0.137255 0.137255 … 0.156863 0.156863; 0.12549 0.105882 … 0.168627 0.168627;;; 0.188235 0.321569 … 0.235294 0.227451; 0.270588 0.247059 … 0.231373 0.219608; … ; 0.313726 0.309804 … 0.34902 0.333333; 0.298039 0.282353 … 0.345098 0.337255;;; 0.0 0.00784314 … 0.0 0.0; 0.0156863 0.00392157 … 0.0 0.0; … ; 0.0392157 0.0352941 … 0.0588235 0.0470588; 0.0313726 0.0235294 … 0.0588235 0.0509804;;;;], θ_true=Float16[-5.3 -5.3 … -1.2 -1.2; -5.3 -5.3 … -1.2 -1.2; … ; -5.3 -5.3 … -1.2 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 ⋮
 DataSample(x=Float32[0.0235294 0.0196078 … 0.427451 0.423529; 0.0156863 0.0156863 … 0.435294 0.443137; … ; 0.0156863 0.0156863 … 0.113725 0.12549; 0.0156863 0.0196078 … 0.129412 0.129412;;; 0.235294 0.231373 … 0.254902 0.25098; 0.219608 0.215686 … 0.258824 0.262745; … ; 0.211765 0.211765 … 0.278431 0.298039; 0.215686 0.223529 … 0.298039 0.294118;;; 0.466667 0.462745 … 0.00392157 0.0; 0.454902 0.454902 … 0.00784314 0.0117647; … ; 0.447059 0.447059 … 0.0196078 0.0313726; 0.447059 0.454902 … 0.0313726 0.027451;;;;], θ_true=Float16[-7.7 -1.2 … -1.2 -1.2; -7.7 -1.2 … -0.8 -1.2; … ; -7.7 -1.2 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.160784 0.160784 … 0.133333 0.12549; 0.160784 0.156863 … 0.105882 0.113725; … ; 0.364706 0.388235 … 0.435294 0.439216; 0.341176 0.415686 … 0.447059 0.435294;;; 0.321569 0.329412 … 0.294118 0.294118; 0.333333 0.313726 … 0.282353 0.286275; … ; 0.270588 0.27451 … 0.258824 0.258824; 0.254902 0.254902 … 0.254902 0.262745;;; 0.0392157 0.0431373 … 0.027451 0.027451; 0.0470588 0.0352941 … 0.0235294 0.027451; … ; 0.0156863 0.0196078 … 0.00784314 0.00784314; 0.00784314 0.00784314 … 0.00392157 0.00784314;;;;], θ_true=Float16[-0.8 -5.3 … -0.8 -0.8; -5.3 -5.3 … -1.2 -0.8; … ; -0.8 -5.3 … -7.7 -7.7; -0.8 -0.8 … -7.7 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.12549 0.133333 … 0.145098 0.156863; 0.113725 0.105882 … 0.137255 0.152941; … ; 0.0431373 0.0 … 0.172549 0.137255; 0.0745098 0.0117647 … 0.145098 0.164706;;; 0.294118 0.294118 … 0.313726 0.329412; 0.286275 0.282353 … 0.305882 0.317647; … ; 0.247059 0.207843 … 0.333333 0.313726; 0.321569 0.219608 … 0.313726 0.360784;;; 0.027451 0.027451 … 0.0392157 0.0431373; 0.027451 0.0235294 … 0.0352941 0.0352941; … ; 0.0117647 0.0 … 0.0470588 0.0352941; 0.027451 0.00392157 … 0.0352941 0.0627451;;;;], θ_true=Float16[-0.8 -0.8 … -0.8 -0.8; -0.8 -0.8 … -1.2 -0.8; … ; -5.3 -0.8 … -1.2 -1.2; -5.3 -0.8 … -1.2 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.439216 0.443137 … 0.431373 0.415686; 0.427451 0.435294 … 0.427451 0.431373; … ; 0.0196078 0.0156863 … 0.113725 0.12549; 0.0156863 0.0156863 … 0.129412 0.129412;;; 0.254902 0.247059 … 0.254902 0.247059; 0.25098 0.258824 … 0.254902 0.254902; … ; 0.211765 0.203922 … 0.278431 0.294118; 0.203922 0.203922 … 0.298039 0.298039;;; 0.00392157 0.0 … 0.00392157 0.0; 0.0 0.00784314 … 0.00392157 0.00392157; … ; 0.443137 0.439216 … 0.0196078 0.0313726; 0.439216 0.439216 … 0.0313726 0.027451;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -1.2 … -1.2 -1.2; … ; -7.7 -7.7 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.12549 0.133333 … 0.160784 0.160784; 0.113725 0.105882 … 0.388235 0.403922; … ; 0.156863 0.164706 … 0.172549 0.286275; 0.14902 0.160784 … 0.266667 0.376471;;; 0.294118 0.294118 … 0.239216 0.188235; 0.286275 0.282353 … 0.247059 0.262745; … ; 0.329412 0.337255 … 0.172549 0.211765; 0.321569 0.321569 … 0.278431 0.211765;;; 0.027451 0.027451 … 0.0941176 0.0509804; 0.027451 0.0235294 … 0.0 0.00392157; … ; 0.0470588 0.0509804 … 0.00392157 0.0117647; 0.0431373 0.0392157 … 0.027451 0.0;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -1.2; -0.8 -0.8 … -0.8 -0.8; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.431373 0.415686 … 0.101961 0.168627; 0.454902 0.337255 … 0.219608 0.32549; … ; 0.156863 0.156863 … 0.388235 0.45098; 0.141176 0.129412 … 0.431373 0.411765;;; 0.25098 0.254902 … 0.321569 0.352941; 0.262745 0.301961 … 0.447059 0.517647; … ; 0.32549 0.32549 … 0.262745 0.25098; 0.309804 0.298039 … 0.262745 0.266667;;; 0.00392157 0.00392157 … 0.0470588 0.0823529; 0.00784314 0.0352941 … 0.0941176 0.141176; … ; 0.0431373 0.0431373 … 0.0156863 0.00392157; 0.0352941 0.027451 … 0.00784314 0.0117647;;;;], θ_true=Float16[-0.8 -0.8 … -5.3 -5.3; -0.8 -5.3 … -5.3 -5.3; … ; -0.8 -1.2 … -0.8 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.137255 0.231373 … 0.129412 0.12549; 0.384314 0.262745 … 0.133333 0.12549; … ; 0.34902 0.235294 … 0.392157 0.34902; 0.172549 0.192157 … 0.411765 0.34902;;; 0.137255 0.231373 … 0.294118 0.290196; 0.384314 0.258824 … 0.298039 0.290196; … ; 0.34902 0.235294 … 0.243137 0.262745; 0.172549 0.192157 … 0.258824 0.254902;;; 0.129412 0.235294 … 0.027451 0.027451; 0.384314 0.258824 … 0.027451 0.0235294; … ; 0.34902 0.235294 … 0.00392157 0.0156863; 0.172549 0.192157 … 0.00784314 0.0117647;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -0.8; -9.2 -9.2 … -0.8 -0.8; … ; -9.2 -1.2 … -0.8 -0.8; -9.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.188235 0.313726 … 0.423529 0.403922; 0.254902 0.329412 … 0.411765 0.4; … ; 0.411765 0.396078 … 0.121569 0.117647; 0.435294 0.384314 … 0.109804 0.129412;;; 0.188235 0.313726 … 0.25098 0.235294; 0.254902 0.329412 … 0.243137 0.235294; … ; 0.243137 0.231373 … 0.282353 0.286275; 0.254902 0.223529 … 0.286275 0.290196;;; 0.188235 0.313726 … 0.00392157 0.0; 0.254902 0.329412 … 0.00392157 0.0; … ; 0.00784314 0.0 … 0.0235294 0.0235294; 0.0117647 0.0 … 0.0235294 0.0235294;;;;], θ_true=Float16[-9.2 -9.2 … -1.2 -1.2; -9.2 -9.2 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -0.8; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])
 DataSample(x=Float32[0.156863 0.14902 … 0.415686 0.364706; 0.14902 0.145098 … 0.313726 0.34902; … ; 0.168627 0.164706 … 0.188235 0.235294; 0.164706 0.160784 … 0.129412 0.156863;;; 0.329412 0.313726 … 0.270588 0.243137; 0.317647 0.309804 … 0.262745 0.270588; … ; 0.333333 0.337255 … 0.188235 0.235294; 0.329412 0.321569 … 0.129412 0.156863;;; 0.0470588 0.0352941 … 0.0117647 0.0117647; 0.0392157 0.0352941 … 0.0196078 0.0235294; … ; 0.0470588 0.0470588 … 0.188235 0.235294; 0.0431373 0.0392157 … 0.129412 0.156863;;;;], θ_true=Float16[-0.8 -1.2 … -9.2 -1.2; -0.8 -1.2 … -9.2 -1.2; … ; -0.8 -1.2 … -9.2 -9.2; -0.8 -0.8 … -9.2 -9.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])</code></pre><p>Split the dataset into training, validation, and test sets:</p><pre><code class="language-julia hljs">train_data, val_data = dataset[1:45], dataset[46:end]</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}[DataSample(x=Float32[0.133333 0.133333 … 0.164706 0.235294; 0.12549 0.105882 … 0.168627 0.313726; … ; 0.247059 0.247059 … 0.0196078 0.0156863; 0.384314 0.423529 … 0.0156863 0.0196078;;; 0.309804 0.294118 … 0.341176 0.356863; 0.298039 0.282353 … 0.329412 0.254902; … ; 0.305882 0.266667 … 0.227451 0.219608; 0.239216 0.239216 … 0.219608 0.227451;;; 0.0392157 0.027451 … 0.0509804 0.0705882; 0.0313726 0.0235294 … 0.0470588 0.0235294; … ; 0.0431373 0.027451 … 0.458824 0.454902; 0.00392157 0.0 … 0.454902 0.458824;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -0.8; -0.8 -0.8 … -1.2 -1.2; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.0196078 0.0196078 … 0.423529 0.411765; 0.0156863 0.0156863 … 0.427451 0.443137; … ; 0.0196078 0.0196078 … 0.439216 0.439216; 0.0196078 0.0196078 … 0.431373 0.435294;;; 0.219608 0.215686 … 0.25098 0.239216; 0.219608 0.207843 … 0.25098 0.258824; … ; 0.227451 0.227451 … 0.258824 0.258824; 0.231373 0.227451 … 0.254902 0.258824;;; 0.454902 0.447059 … 0.00784314 0.00392157; 0.454902 0.443137 … 0.00784314 0.0117647; … ; 0.458824 0.462745 … 0.00784314 0.00784314; 0.462745 0.458824 … 0.00392157 0.00784314;;;;], θ_true=Float16[-7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -1.2 -1.2; … ; -7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -9.2 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.223529 0.0 … 0.160784 0.164706; 0.203922 0.0588235 … 0.156863 0.156863; … ; 0.0235294 0.00392157 … 0.00392157 0.0235294; 0.0352941 0.0117647 … 0.0 0.0;;; 0.407843 0.25098 … 0.32549 0.337255; 0.356863 0.32549 … 0.321569 0.329412; … ; 0.196078 0.215686 … 0.207843 0.235294; 0.215686 0.196078 … 0.231373 0.247059;;; 0.0823529 0.0 … 0.0431373 0.0509804; 0.054902 0.0352941 … 0.0431373 0.0431373; … ; 0.0 0.0 … 0.0 0.00784314; 0.0196078 0.0 … 0.0 0.0;;;;], θ_true=Float16[-5.3 -5.3 … -1.2 -0.8; -5.3 -5.3 … -1.2 -0.8; … ; -5.3 -5.3 … -5.3 -5.3; -5.3 -5.3 … -5.3 -5.3], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.431373 0.454902 … 0.0156863 0.0196078; 0.411765 0.368627 … 0.0156863 0.0156863; … ; 0.14902 0.152941 … 0.152941 0.164706; 0.156863 0.137255 … 0.164706 0.164706;;; 0.25098 0.258824 … 0.219608 0.227451; 0.270588 0.278431 … 0.219608 0.219608; … ; 0.313726 0.321569 … 0.321569 0.333333; 0.32549 0.301961 … 0.333333 0.333333;;; 0.00392157 0.00784314 … 0.454902 0.462745; 0.0156863 0.0235294 … 0.454902 0.454902; … ; 0.0392157 0.0431373 … 0.0392157 0.0470588; 0.0431373 0.0313726 … 0.0470588 0.0470588;;;;], θ_true=Float16[-1.2 -7.7 … -7.7 -7.7; -7.7 -1.2 … -7.7 -7.7; … ; -0.8 -0.8 … -0.8 -5.3; -0.8 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.152941 0.317647 … 0.435294 0.403922; 0.376471 0.305882 … 0.431373 0.411765; … ; 0.2 0.121569 … 0.360784 0.411765; 0.0901961 0.172549 … 0.219608 0.447059;;; 0.152941 0.317647 … 0.258824 0.239216; 0.376471 0.305882 … 0.254902 0.243137; … ; 0.2 0.121569 … 0.223529 0.286275; 0.0901961 0.172549 … 0.164706 0.258824;;; 0.152941 0.317647 … 0.00784314 0.0; 0.376471 0.305882 … 0.00392157 0.0; … ; 0.2 0.121569 … 0.027451 0.109804; 0.0901961 0.172549 … 0.0862745 0.0;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -1.2; -9.2 -9.2 … -0.8 -1.2; … ; -9.2 -9.2 … -9.2 -1.2; -9.2 -9.2 … -9.2 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 0 1; 0 0 … 0 1]), DataSample(x=Float32[0.0235294 0.0196078 … 0.164706 0.164706; 0.0156863 0.0156863 … 0.168627 0.164706; … ; 0.168627 0.164706 … 0.431373 0.427451; 0.156863 0.160784 … 0.431373 0.427451;;; 0.227451 0.223529 … 0.333333 0.329412; 0.215686 0.207843 … 0.337255 0.329412; … ; 0.337255 0.337255 … 0.254902 0.254902; 0.329412 0.317647 … 0.254902 0.254902;;; 0.458824 0.454902 … 0.0470588 0.0470588; 0.45098 0.443137 … 0.0470588 0.0470588; … ; 0.0470588 0.0470588 … 0.00392157 0.00392157; 0.0431373 0.0392157 … 0.00392157 0.00392157;;;;], θ_true=Float16[-7.7 -7.7 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8; … ; -1.2 -1.2 … -9.2 -9.2; -0.8 -1.2 … -9.2 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.407843 0.415686 … 0.380392 0.286275; 0.407843 0.411765 … 0.376471 0.309804; … ; 0.12549 0.113725 … 0.152941 0.160784; 0.129412 0.129412 … 0.156863 0.152941;;; 0.239216 0.243137 … 0.203922 0.278431; 0.239216 0.243137 … 0.278431 0.258824; … ; 0.298039 0.278431 … 0.317647 0.329412; 0.294118 0.298039 … 0.32549 0.333333;;; 0.00392157 0.00784314 … 0.0 0.0352941; 0.00392157 0.00392157 … 0.0235294 0.0235294; … ; 0.0313726 0.0196078 … 0.0392157 0.0470588; 0.027451 0.0313726 … 0.0431373 0.0470588;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -0.8 … -1.2 -1.2; … ; -0.8 -1.2 … -5.3 -5.3; -0.8 -0.8 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 0 0; 0 0 … 1 1]), DataSample(x=Float32[0.0156863 0.0156863 … 0.439216 0.427451; 0.0156863 0.0156863 … 0.431373 0.435294; … ; 0.337255 0.364706 … 0.168627 0.196078; 0.262745 0.368627 … 0.227451 0.341176;;; 0.207843 0.2 … 0.258824 0.25098; 0.203922 0.207843 … 0.254902 0.254902; … ; 0.239216 0.27451 … 0.34902 0.376471; 0.317647 0.243137 … 0.360784 0.247059;;; 0.443137 0.435294 … 0.0117647 0.00784314; 0.439216 0.443137 … 0.00784314 0.00784314; … ; 0.0156863 0.0196078 … 0.054902 0.0784314; 0.0470588 0.0117647 … 0.0705882 0.0196078;;;;], θ_true=Float16[-7.7 -7.7 … -1.2 -1.2; -7.7 -7.7 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -1.2; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.0235294 0.0196078 … 0.443137 0.439216; 0.0156863 0.0156863 … 0.435294 0.443137; … ; 0.396078 0.392157 … 0.439216 0.439216; 0.392157 0.392157 … 0.431373 0.435294;;; 0.235294 0.231373 … 0.258824 0.258824; 0.219608 0.215686 … 0.258824 0.258824; … ; 0.235294 0.231373 … 0.258824 0.258824; 0.231373 0.227451 … 0.254902 0.258824;;; 0.466667 0.462745 … 0.00784314 0.00784314; 0.454902 0.454902 … 0.00784314 0.00784314; … ; 0.0 0.0 … 0.00784314 0.00784314; 0.0 0.0 … 0.00392157 0.00784314;;;;], θ_true=Float16[-7.7 -7.7 … -7.7 -1.2; -7.7 -7.7 … -7.7 -1.2; … ; -1.2 -1.2 … -1.2 -9.2; -1.2 -1.2 … -1.2 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.0 0.0235294 … 0.4 0.392157; 0.0196078 0.00392157 … 0.392157 0.376471; … ; 0.137255 0.137255 … 0.156863 0.156863; 0.12549 0.105882 … 0.168627 0.168627;;; 0.188235 0.321569 … 0.235294 0.227451; 0.270588 0.247059 … 0.231373 0.219608; … ; 0.313726 0.309804 … 0.34902 0.333333; 0.298039 0.282353 … 0.345098 0.337255;;; 0.0 0.00784314 … 0.0 0.0; 0.0156863 0.00392157 … 0.0 0.0; … ; 0.0392157 0.0352941 … 0.0588235 0.0470588; 0.0313726 0.0235294 … 0.0588235 0.0509804;;;;], θ_true=Float16[-5.3 -5.3 … -1.2 -1.2; -5.3 -5.3 … -1.2 -1.2; … ; -5.3 -5.3 … -1.2 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])  …  DataSample(x=Float32[0.403922 0.431373 … 0.443137 0.435294; 0.435294 0.435294 … 0.427451 0.435294; … ; 0.0235294 0.00392157 … 0.00392157 0.0235294; 0.0352941 0.0117647 … 0.0 0.0;;; 0.235294 0.254902 … 0.258824 0.254902; 0.258824 0.254902 … 0.25098 0.254902; … ; 0.196078 0.215686 … 0.207843 0.235294; 0.215686 0.196078 … 0.231373 0.247059;;; 0.0 0.00784314 … 0.00784314 0.00784314; 0.00784314 0.00784314 … 0.00784314 0.00784314; … ; 0.0 0.0 … 0.0 0.00784314; 0.0196078 0.0 … 0.0 0.0;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -1.2 … -1.2 -1.2; … ; -5.3 -5.3 … -5.3 -5.3; -5.3 -5.3 … -5.3 -5.3], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.407843 0.415686 … 0.380392 0.286275; 0.407843 0.411765 … 0.376471 0.309804; … ; 0.164706 0.164706 … 0.443137 0.427451; 0.152941 0.160784 … 0.423529 0.419608;;; 0.239216 0.243137 … 0.203922 0.278431; 0.239216 0.243137 … 0.278431 0.258824; … ; 0.329412 0.32549 … 0.262745 0.25098; 0.321569 0.329412 … 0.25098 0.247059;;; 0.00392157 0.00784314 … 0.0 0.0352941; 0.00392157 0.00392157 … 0.0235294 0.0235294; … ; 0.0470588 0.0431373 … 0.00784314 0.00392157; 0.0392157 0.0470588 … 0.00392157 0.00784314;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -7.7 … -1.2 -1.2; … ; -0.8 -0.8 … -1.2 -1.2; -0.8 -0.8 … -1.2 -1.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.27451 0.0196078 … 0.00392157 0.141176; 0.137255 0.0627451 … 0.0196078 0.0823529; … ; 0.427451 0.427451 … 0.396078 0.4; 0.427451 0.403922 … 0.392157 0.396078;;; 0.470588 0.231373 … 0.254902 0.376471; 0.403922 0.317647 … 0.231373 0.356863; … ; 0.25098 0.25098 … 0.235294 0.235294; 0.25098 0.235294 … 0.227451 0.231373;;; 0.141176 0.0156863 … 0.00392157 0.0745098; 0.0705882 0.0392157 … 0.00784314 0.0352941; … ; 0.00784314 0.00392157 … 0.0 0.0; 0.00392157 0.00392157 … 0.0 0.0;;;;], θ_true=Float16[-5.3 -5.3 … -5.3 -5.3; -5.3 -5.3 … -5.3 -5.3; … ; -1.2 -0.8 … -1.2 -1.2; -1.2 -0.8 … -1.2 -1.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.145098 0.137255 … 0.129412 0.137255; 0.121569 0.12549 … 0.117647 0.109804; … ; 0.0235294 0.00392157 … 0.0784314 0.0117647; 0.0352941 0.0117647 … 0.0352941 0.0588235;;; 0.309804 0.309804 … 0.294118 0.305882; 0.294118 0.294118 … 0.298039 0.286275; … ; 0.196078 0.215686 … 0.301961 0.211765; 0.215686 0.196078 … 0.282353 0.301961;;; 0.0352941 0.0352941 … 0.027451 0.0313726; 0.027451 0.027451 … 0.0313726 0.027451; … ; 0.0 0.0 … 0.0352941 0.00784314; 0.0196078 0.0 … 0.0156863 0.0352941;;;;], θ_true=Float16[-0.8 -0.8 … -0.8 -0.8; -0.8 -0.8 … -0.8 -0.8; … ; -5.3 -5.3 … -5.3 -5.3; -5.3 -5.3 … -5.3 -5.3], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.458824 0.282353 … 0.431373 0.415686; 0.356863 0.172549 … 0.427451 0.431373; … ; 0.384314 0.396078 … 0.172549 0.168627; 0.388235 0.392157 … 0.164706 0.172549;;; 0.25098 0.270588 … 0.254902 0.247059; 0.270588 0.196078 … 0.254902 0.254902; … ; 0.223529 0.231373 … 0.352941 0.356863; 0.227451 0.231373 … 0.337255 0.345098;;; 0.00392157 0.0156863 … 0.00392157 0.0; 0.00784314 0.0117647 … 0.00392157 0.00392157; … ; 0.0 0.0 … 0.0588235 0.0627451; 0.0 0.0 … 0.0509804 0.054902;;;;], θ_true=Float16[-7.7 -1.2 … -7.7 -1.2; -7.7 -1.2 … -1.2 -7.7; … ; -1.2 -1.2 … -1.2 -1.2; -1.2 -1.2 … -1.2 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.121569 0.231373 … 0.435294 0.407843; 0.121569 0.266667 … 0.435294 0.423529; … ; 0.12549 0.12549 … 0.388235 0.45098; 0.117647 0.105882 … 0.431373 0.411765;;; 0.121569 0.231373 … 0.254902 0.239216; 0.121569 0.266667 … 0.258824 0.25098; … ; 0.301961 0.301961 … 0.262745 0.25098; 0.294118 0.282353 … 0.262745 0.266667;;; 0.121569 0.231373 … 0.00784314 0.0; 0.121569 0.266667 … 0.00392157 0.0; … ; 0.0313726 0.0313726 … 0.0156863 0.00392157; 0.0313726 0.0235294 … 0.00784314 0.0117647;;;;], θ_true=Float16[-9.2 -9.2 … -1.2 -1.2; -9.2 -9.2 … -1.2 -1.2; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -1.2 -1.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 0 0; 0 0 … 1 1]), DataSample(x=Float32[0.0235294 0.0196078 … 0.427451 0.423529; 0.0156863 0.0156863 … 0.435294 0.443137; … ; 0.0156863 0.0156863 … 0.113725 0.12549; 0.0156863 0.0196078 … 0.129412 0.129412;;; 0.235294 0.231373 … 0.254902 0.25098; 0.219608 0.215686 … 0.258824 0.262745; … ; 0.211765 0.211765 … 0.278431 0.298039; 0.215686 0.223529 … 0.298039 0.294118;;; 0.466667 0.462745 … 0.00392157 0.0; 0.454902 0.454902 … 0.00784314 0.0117647; … ; 0.447059 0.447059 … 0.0196078 0.0313726; 0.447059 0.454902 … 0.0313726 0.027451;;;;], θ_true=Float16[-7.7 -1.2 … -1.2 -1.2; -7.7 -1.2 … -0.8 -1.2; … ; -7.7 -1.2 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 0 1 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.160784 0.160784 … 0.133333 0.12549; 0.160784 0.156863 … 0.105882 0.113725; … ; 0.364706 0.388235 … 0.435294 0.439216; 0.341176 0.415686 … 0.447059 0.435294;;; 0.321569 0.329412 … 0.294118 0.294118; 0.333333 0.313726 … 0.282353 0.286275; … ; 0.270588 0.27451 … 0.258824 0.258824; 0.254902 0.254902 … 0.254902 0.262745;;; 0.0392157 0.0431373 … 0.027451 0.027451; 0.0470588 0.0352941 … 0.0235294 0.027451; … ; 0.0156863 0.0196078 … 0.00784314 0.00784314; 0.00784314 0.00784314 … 0.00392157 0.00784314;;;;], θ_true=Float16[-0.8 -5.3 … -0.8 -0.8; -5.3 -5.3 … -1.2 -0.8; … ; -0.8 -5.3 … -7.7 -7.7; -0.8 -0.8 … -7.7 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.12549 0.133333 … 0.145098 0.156863; 0.113725 0.105882 … 0.137255 0.152941; … ; 0.0431373 0.0 … 0.172549 0.137255; 0.0745098 0.0117647 … 0.145098 0.164706;;; 0.294118 0.294118 … 0.313726 0.329412; 0.286275 0.282353 … 0.305882 0.317647; … ; 0.247059 0.207843 … 0.333333 0.313726; 0.321569 0.219608 … 0.313726 0.360784;;; 0.027451 0.027451 … 0.0392157 0.0431373; 0.027451 0.0235294 … 0.0352941 0.0352941; … ; 0.0117647 0.0 … 0.0470588 0.0352941; 0.027451 0.00392157 … 0.0352941 0.0627451;;;;], θ_true=Float16[-0.8 -0.8 … -0.8 -0.8; -0.8 -0.8 … -1.2 -0.8; … ; -5.3 -0.8 … -1.2 -1.2; -5.3 -0.8 … -1.2 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.439216 0.443137 … 0.431373 0.415686; 0.427451 0.435294 … 0.427451 0.431373; … ; 0.0196078 0.0156863 … 0.113725 0.12549; 0.0156863 0.0156863 … 0.129412 0.129412;;; 0.254902 0.247059 … 0.254902 0.247059; 0.25098 0.258824 … 0.254902 0.254902; … ; 0.211765 0.203922 … 0.278431 0.294118; 0.203922 0.203922 … 0.298039 0.298039;;; 0.00392157 0.0 … 0.00392157 0.0; 0.0 0.00784314 … 0.00392157 0.00392157; … ; 0.443137 0.439216 … 0.0196078 0.0313726; 0.439216 0.439216 … 0.0313726 0.027451;;;;], θ_true=Float16[-1.2 -1.2 … -1.2 -1.2; -1.2 -1.2 … -1.2 -1.2; … ; -7.7 -7.7 … -0.8 -0.8; -7.7 -7.7 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])], DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}[DataSample(x=Float32[0.12549 0.133333 … 0.160784 0.160784; 0.113725 0.105882 … 0.388235 0.403922; … ; 0.156863 0.164706 … 0.172549 0.286275; 0.14902 0.160784 … 0.266667 0.376471;;; 0.294118 0.294118 … 0.239216 0.188235; 0.286275 0.282353 … 0.247059 0.262745; … ; 0.329412 0.337255 … 0.172549 0.211765; 0.321569 0.321569 … 0.278431 0.211765;;; 0.027451 0.027451 … 0.0941176 0.0509804; 0.027451 0.0235294 … 0.0 0.00392157; … ; 0.0470588 0.0509804 … 0.00392157 0.0117647; 0.0431373 0.0392157 … 0.027451 0.0;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -1.2; -0.8 -0.8 … -0.8 -0.8; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.431373 0.415686 … 0.101961 0.168627; 0.454902 0.337255 … 0.219608 0.32549; … ; 0.156863 0.156863 … 0.388235 0.45098; 0.141176 0.129412 … 0.431373 0.411765;;; 0.25098 0.254902 … 0.321569 0.352941; 0.262745 0.301961 … 0.447059 0.517647; … ; 0.32549 0.32549 … 0.262745 0.25098; 0.309804 0.298039 … 0.262745 0.266667;;; 0.00392157 0.00392157 … 0.0470588 0.0823529; 0.00784314 0.0352941 … 0.0941176 0.141176; … ; 0.0431373 0.0431373 … 0.0156863 0.00392157; 0.0352941 0.027451 … 0.00784314 0.0117647;;;;], θ_true=Float16[-0.8 -0.8 … -5.3 -5.3; -0.8 -5.3 … -5.3 -5.3; … ; -0.8 -1.2 … -0.8 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.137255 0.231373 … 0.129412 0.12549; 0.384314 0.262745 … 0.133333 0.12549; … ; 0.34902 0.235294 … 0.392157 0.34902; 0.172549 0.192157 … 0.411765 0.34902;;; 0.137255 0.231373 … 0.294118 0.290196; 0.384314 0.258824 … 0.298039 0.290196; … ; 0.34902 0.235294 … 0.243137 0.262745; 0.172549 0.192157 … 0.258824 0.254902;;; 0.129412 0.235294 … 0.027451 0.027451; 0.384314 0.258824 … 0.027451 0.0235294; … ; 0.34902 0.235294 … 0.00392157 0.0156863; 0.172549 0.192157 … 0.00784314 0.0117647;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -0.8; -9.2 -9.2 … -0.8 -0.8; … ; -9.2 -1.2 … -0.8 -0.8; -9.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.188235 0.313726 … 0.423529 0.403922; 0.254902 0.329412 … 0.411765 0.4; … ; 0.411765 0.396078 … 0.121569 0.117647; 0.435294 0.384314 … 0.109804 0.129412;;; 0.188235 0.313726 … 0.25098 0.235294; 0.254902 0.329412 … 0.243137 0.235294; … ; 0.243137 0.231373 … 0.282353 0.286275; 0.254902 0.223529 … 0.286275 0.290196;;; 0.188235 0.313726 … 0.00392157 0.0; 0.254902 0.329412 … 0.00392157 0.0; … ; 0.00784314 0.0 … 0.0235294 0.0235294; 0.0117647 0.0 … 0.0235294 0.0235294;;;;], θ_true=Float16[-9.2 -9.2 … -1.2 -1.2; -9.2 -9.2 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -0.8; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.156863 0.14902 … 0.415686 0.364706; 0.14902 0.145098 … 0.313726 0.34902; … ; 0.168627 0.164706 … 0.188235 0.235294; 0.164706 0.160784 … 0.129412 0.156863;;; 0.329412 0.313726 … 0.270588 0.243137; 0.317647 0.309804 … 0.262745 0.270588; … ; 0.333333 0.337255 … 0.188235 0.235294; 0.329412 0.321569 … 0.129412 0.156863;;; 0.0470588 0.0352941 … 0.0117647 0.0117647; 0.0392157 0.0352941 … 0.0196078 0.0235294; … ; 0.0470588 0.0470588 … 0.188235 0.235294; 0.0431373 0.0392157 … 0.129412 0.156863;;;;], θ_true=Float16[-0.8 -1.2 … -9.2 -1.2; -0.8 -1.2 … -9.2 -1.2; … ; -0.8 -1.2 … -9.2 -9.2; -0.8 -0.8 … -9.2 -9.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])])</code></pre><h2 id="Creating-a-Policy"><a class="docs-heading-anchor" href="#Creating-a-Policy">Creating a Policy</a><a id="Creating-a-Policy-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-a-Policy" title="Permalink"></a></h2><p>A <code>DFLPolicy</code> combines a statistical model (neural network) with a combinatorial optimizer. The benchmark provides utilities to generate appropriate models and optimizers:</p><pre><code class="language-julia hljs">model = generate_statistical_model(benchmark)
maximizer = generate_maximizer(benchmark; dijkstra=true)
policy = DFLPolicy(model, maximizer)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">DFLPolicy{Flux.Chain{Tuple{Flux.Conv{2, 4, typeof(identity), Array{Float32, 4}, Bool}, Flux.BatchNorm{typeof(NNlib.relu), Vector{Float32}, Float32, Vector{Float32}}, Flux.MaxPool{2, 4}, Flux.Parallel{PartialFunctions.PartialFunction{nothing, nothing, typeof(Metalhead.addact), Tuple{typeof(NNlib.relu)}, @NamedTuple{}}, Tuple{typeof(identity), Flux.Chain{Tuple{Flux.Conv{2, 4, typeof(identity), Array{Float32, 4}, Bool}, Flux.BatchNorm{typeof(identity), Vector{Float32}, Float32, Vector{Float32}}, typeof(NNlib.relu), Flux.Conv{2, 4, typeof(identity), Array{Float32, 4}, Bool}, Flux.BatchNorm{typeof(identity), Vector{Float32}, Float32, Vector{Float32}}}}}}, Flux.AdaptiveMaxPool{4, 2}, typeof(DecisionFocusedLearningBenchmarks.Utils.average_tensor), typeof(DecisionFocusedLearningBenchmarks.Utils.neg_tensor), typeof(DecisionFocusedLearningBenchmarks.Utils.squeeze_last_dims)}}, typeof(DecisionFocusedLearningBenchmarks.Warcraft.dijkstra_maximizer)}(Chain(Conv((7, 7), 3 =&gt; 64, pad=3, stride=2, bias=false), BatchNorm(64, relu), MaxPool((3, 3), pad=1, stride=2), Parallel(addact(NNlib.relu, ...), identity, Chain(Conv((3, 3), 64 =&gt; 64, pad=1, bias=false), BatchNorm(64), relu, Conv((3, 3), 64 =&gt; 64, pad=1, bias=false), BatchNorm(64))), AdaptiveMaxPool((12, 12)), average_tensor, neg_tensor, squeeze_last_dims), DecisionFocusedLearningBenchmarks.Warcraft.dijkstra_maximizer)</code></pre><h2 id="Configuring-the-Algorithm"><a class="docs-heading-anchor" href="#Configuring-the-Algorithm">Configuring the Algorithm</a><a id="Configuring-the-Algorithm-1"></a><a class="docs-heading-anchor-permalink" href="#Configuring-the-Algorithm" title="Permalink"></a></h2><p>We&#39;ll use the Perturbed Fenchel-Young Loss Imitation algorithm:</p><pre><code class="language-julia hljs">algorithm = PerturbedFenchelYoungLossImitation(;
    nb_samples=100,          # Number of perturbation samples for gradient estimation
    ε=0.2,                  # Perturbation magnitude
    threaded=true,          # Use multi-threading for perturbations
    training_optimizer=Adam(1e-3),  # Flux optimizer with learning rate
    seed=42,                 # Random seed for reproducibility
    use_multiplicative_perturbation=true,  # Use multiplicative perturbations
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">PerturbedFenchelYoungLossImitation{Optimisers.Adam{Float64, Tuple{Float64, Float64}, Float64}, Int64}(100, 0.2, true, Optimisers.Adam(eta=0.001, beta=(0.9, 0.999), epsilon=1.0e-8), 42, true)</code></pre><h2 id="Setting-Up-Metrics"><a class="docs-heading-anchor" href="#Setting-Up-Metrics">Setting Up Metrics</a><a id="Setting-Up-Metrics-1"></a><a class="docs-heading-anchor-permalink" href="#Setting-Up-Metrics" title="Permalink"></a></h2><p>We&#39;ll track several metrics during training:</p><p>Validation loss metric</p><pre><code class="language-julia hljs">val_loss_metric = FYLLossMetric(val_data, :validation_loss)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FYLLossMetric{Vector{DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}}}(DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}[DataSample(x=Float32[0.12549 0.133333 … 0.160784 0.160784; 0.113725 0.105882 … 0.388235 0.403922; … ; 0.156863 0.164706 … 0.172549 0.286275; 0.14902 0.160784 … 0.266667 0.376471;;; 0.294118 0.294118 … 0.239216 0.188235; 0.286275 0.282353 … 0.247059 0.262745; … ; 0.329412 0.337255 … 0.172549 0.211765; 0.321569 0.321569 … 0.278431 0.211765;;; 0.027451 0.027451 … 0.0941176 0.0509804; 0.027451 0.0235294 … 0.0 0.00392157; … ; 0.0470588 0.0509804 … 0.00392157 0.0117647; 0.0431373 0.0392157 … 0.027451 0.0;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -1.2; -0.8 -0.8 … -0.8 -0.8; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.431373 0.415686 … 0.101961 0.168627; 0.454902 0.337255 … 0.219608 0.32549; … ; 0.156863 0.156863 … 0.388235 0.45098; 0.141176 0.129412 … 0.431373 0.411765;;; 0.25098 0.254902 … 0.321569 0.352941; 0.262745 0.301961 … 0.447059 0.517647; … ; 0.32549 0.32549 … 0.262745 0.25098; 0.309804 0.298039 … 0.262745 0.266667;;; 0.00392157 0.00392157 … 0.0470588 0.0823529; 0.00784314 0.0352941 … 0.0941176 0.141176; … ; 0.0431373 0.0431373 … 0.0156863 0.00392157; 0.0352941 0.027451 … 0.00784314 0.0117647;;;;], θ_true=Float16[-0.8 -0.8 … -5.3 -5.3; -0.8 -5.3 … -5.3 -5.3; … ; -0.8 -1.2 … -0.8 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.137255 0.231373 … 0.129412 0.12549; 0.384314 0.262745 … 0.133333 0.12549; … ; 0.34902 0.235294 … 0.392157 0.34902; 0.172549 0.192157 … 0.411765 0.34902;;; 0.137255 0.231373 … 0.294118 0.290196; 0.384314 0.258824 … 0.298039 0.290196; … ; 0.34902 0.235294 … 0.243137 0.262745; 0.172549 0.192157 … 0.258824 0.254902;;; 0.129412 0.235294 … 0.027451 0.027451; 0.384314 0.258824 … 0.027451 0.0235294; … ; 0.34902 0.235294 … 0.00392157 0.0156863; 0.172549 0.192157 … 0.00784314 0.0117647;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -0.8; -9.2 -9.2 … -0.8 -0.8; … ; -9.2 -1.2 … -0.8 -0.8; -9.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.188235 0.313726 … 0.423529 0.403922; 0.254902 0.329412 … 0.411765 0.4; … ; 0.411765 0.396078 … 0.121569 0.117647; 0.435294 0.384314 … 0.109804 0.129412;;; 0.188235 0.313726 … 0.25098 0.235294; 0.254902 0.329412 … 0.243137 0.235294; … ; 0.243137 0.231373 … 0.282353 0.286275; 0.254902 0.223529 … 0.286275 0.290196;;; 0.188235 0.313726 … 0.00392157 0.0; 0.254902 0.329412 … 0.00392157 0.0; … ; 0.00784314 0.0 … 0.0235294 0.0235294; 0.0117647 0.0 … 0.0235294 0.0235294;;;;], θ_true=Float16[-9.2 -9.2 … -1.2 -1.2; -9.2 -9.2 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -0.8; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.156863 0.14902 … 0.415686 0.364706; 0.14902 0.145098 … 0.313726 0.34902; … ; 0.168627 0.164706 … 0.188235 0.235294; 0.164706 0.160784 … 0.129412 0.156863;;; 0.329412 0.313726 … 0.270588 0.243137; 0.317647 0.309804 … 0.262745 0.270588; … ; 0.333333 0.337255 … 0.188235 0.235294; 0.329412 0.321569 … 0.129412 0.156863;;; 0.0470588 0.0352941 … 0.0117647 0.0117647; 0.0392157 0.0352941 … 0.0196078 0.0235294; … ; 0.0470588 0.0470588 … 0.188235 0.235294; 0.0431373 0.0392157 … 0.129412 0.156863;;;;], θ_true=Float16[-0.8 -1.2 … -9.2 -1.2; -0.8 -1.2 … -9.2 -1.2; … ; -0.8 -1.2 … -9.2 -9.2; -0.8 -0.8 … -9.2 -9.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])], LossAccumulator(:validation_loss, 0.0, 0))</code></pre><p>Validation gap metric</p><pre><code class="language-julia hljs">val_gap_metric = FunctionMetric(:val_gap, val_data) do ctx, data
    compute_gap(benchmark, data, ctx.policy.statistical_model, ctx.policy.maximizer)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FunctionMetric{Main.var&quot;#2#3&quot;, Vector{DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}}}(Main.var&quot;#2#3&quot;(), :val_gap, DecisionFocusedLearningBenchmarks.Utils.DataSample{@NamedTuple{}, Array{Float32, 4}, BitMatrix, Matrix{Float16}}[DataSample(x=Float32[0.12549 0.133333 … 0.160784 0.160784; 0.113725 0.105882 … 0.388235 0.403922; … ; 0.156863 0.164706 … 0.172549 0.286275; 0.14902 0.160784 … 0.266667 0.376471;;; 0.294118 0.294118 … 0.239216 0.188235; 0.286275 0.282353 … 0.247059 0.262745; … ; 0.329412 0.337255 … 0.172549 0.211765; 0.321569 0.321569 … 0.278431 0.211765;;; 0.027451 0.027451 … 0.0941176 0.0509804; 0.027451 0.0235294 … 0.0 0.00392157; … ; 0.0470588 0.0509804 … 0.00392157 0.0117647; 0.0431373 0.0392157 … 0.027451 0.0;;;;], θ_true=Float16[-0.8 -0.8 … -1.2 -1.2; -0.8 -0.8 … -0.8 -0.8; … ; -0.8 -0.8 … -7.7 -7.7; -0.8 -0.8 … -7.7 -7.7], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.431373 0.415686 … 0.101961 0.168627; 0.454902 0.337255 … 0.219608 0.32549; … ; 0.156863 0.156863 … 0.388235 0.45098; 0.141176 0.129412 … 0.431373 0.411765;;; 0.25098 0.254902 … 0.321569 0.352941; 0.262745 0.301961 … 0.447059 0.517647; … ; 0.32549 0.32549 … 0.262745 0.25098; 0.309804 0.298039 … 0.262745 0.266667;;; 0.00392157 0.00392157 … 0.0470588 0.0823529; 0.00784314 0.0352941 … 0.0941176 0.141176; … ; 0.0431373 0.0431373 … 0.0156863 0.00392157; 0.0352941 0.027451 … 0.00784314 0.0117647;;;;], θ_true=Float16[-0.8 -0.8 … -5.3 -5.3; -0.8 -5.3 … -5.3 -5.3; … ; -0.8 -1.2 … -0.8 -1.2; -0.8 -0.8 … -0.8 -1.2], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.137255 0.231373 … 0.129412 0.12549; 0.384314 0.262745 … 0.133333 0.12549; … ; 0.34902 0.235294 … 0.392157 0.34902; 0.172549 0.192157 … 0.411765 0.34902;;; 0.137255 0.231373 … 0.294118 0.290196; 0.384314 0.258824 … 0.298039 0.290196; … ; 0.34902 0.235294 … 0.243137 0.262745; 0.172549 0.192157 … 0.258824 0.254902;;; 0.129412 0.235294 … 0.027451 0.027451; 0.384314 0.258824 … 0.027451 0.0235294; … ; 0.34902 0.235294 … 0.00392157 0.0156863; 0.172549 0.192157 … 0.00784314 0.0117647;;;;], θ_true=Float16[-9.2 -9.2 … -0.8 -0.8; -9.2 -9.2 … -0.8 -0.8; … ; -9.2 -1.2 … -0.8 -0.8; -9.2 -1.2 … -0.8 -0.8], y_true=Bool[1 1 … 0 0; 0 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.188235 0.313726 … 0.423529 0.403922; 0.254902 0.329412 … 0.411765 0.4; … ; 0.411765 0.396078 … 0.121569 0.117647; 0.435294 0.384314 … 0.109804 0.129412;;; 0.188235 0.313726 … 0.25098 0.235294; 0.254902 0.329412 … 0.243137 0.235294; … ; 0.243137 0.231373 … 0.282353 0.286275; 0.254902 0.223529 … 0.286275 0.290196;;; 0.188235 0.313726 … 0.00392157 0.0; 0.254902 0.329412 … 0.00392157 0.0; … ; 0.00784314 0.0 … 0.0235294 0.0235294; 0.0117647 0.0 … 0.0235294 0.0235294;;;;], θ_true=Float16[-9.2 -9.2 … -1.2 -1.2; -9.2 -9.2 … -1.2 -1.2; … ; -1.2 -1.2 … -0.8 -0.8; -1.2 -1.2 … -0.8 -0.8], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1]), DataSample(x=Float32[0.156863 0.14902 … 0.415686 0.364706; 0.14902 0.145098 … 0.313726 0.34902; … ; 0.168627 0.164706 … 0.188235 0.235294; 0.164706 0.160784 … 0.129412 0.156863;;; 0.329412 0.313726 … 0.270588 0.243137; 0.317647 0.309804 … 0.262745 0.270588; … ; 0.333333 0.337255 … 0.188235 0.235294; 0.329412 0.321569 … 0.129412 0.156863;;; 0.0470588 0.0352941 … 0.0117647 0.0117647; 0.0392157 0.0352941 … 0.0196078 0.0235294; … ; 0.0470588 0.0470588 … 0.188235 0.235294; 0.0431373 0.0392157 … 0.129412 0.156863;;;;], θ_true=Float16[-0.8 -1.2 … -9.2 -1.2; -0.8 -1.2 … -9.2 -1.2; … ; -0.8 -1.2 … -9.2 -9.2; -0.8 -0.8 … -9.2 -9.2], y_true=Bool[1 0 … 0 0; 1 0 … 0 0; … ; 0 0 … 1 0; 0 0 … 0 1])])</code></pre><h2 id="Training"><a class="docs-heading-anchor" href="#Training">Training</a><a id="Training-1"></a><a class="docs-heading-anchor-permalink" href="#Training" title="Permalink"></a></h2><p>Now we train the policy:</p><pre><code class="language-julia hljs">data_loader = DataLoader(train_data; batchsize=50)
history = train_policy!(
    algorithm, policy, data_loader; epochs=50, metrics=(val_loss_metric, val_gap_metric)
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">MVHistory{ValueHistories.History}
  :training_loss =&gt; 51 elements {Int64,Float64}
  :val_gap =&gt; 51 elements {Int64,Float16}
  :validation_loss =&gt; 51 elements {Int64,Float64}</code></pre><h2 id="Results-Analysis"><a class="docs-heading-anchor" href="#Results-Analysis">Results Analysis</a><a id="Results-Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Results-Analysis" title="Permalink"></a></h2><p>Let&#39;s examine the training progress:</p><p>Extract training history</p><pre><code class="language-julia hljs">train_loss_epochs, train_loss_values = get(history, :training_loss)
val_loss_epochs, val_loss_values = get(history, :validation_loss)
val_gap_epochs, val_gap_values = get(history, :val_gap)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">([0, 1, 2, 3, 4, 5, 6, 7, 8, 9  …  41, 42, 43, 44, 45, 46, 47, 48, 49, 50], Float16[0.775, 0.775, 0.3687, 0.3687, 0.3687, 0.236, 0.236, 0.3687, 0.3687, 0.3687  …  0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0])</code></pre><p>Plot training and validation loss</p><pre><code class="language-julia hljs">p1 = plot(
    train_loss_epochs,
    train_loss_values;
    label=&quot;Training&quot;,
    xlabel=&quot;Epoch&quot;,
    ylabel=&quot;FYL Loss&quot;,
    title=&quot;Training Progress&quot;,
    linewidth=2,
)
plot!(p1, val_loss_epochs, val_loss_values; label=&quot;Validation&quot;, linewidth=2)</code></pre><img src="ba766796.svg" alt="Example block output"/><p>Plot gap evolution</p><pre><code class="language-julia hljs">p2 = plot(
    val_gap_epochs,
    val_gap_values;
    label=&quot;Validation Gap&quot;,
    xlabel=&quot;Epoch&quot;,
    ylabel=&quot;Gap (Regret)&quot;,
    title=&quot;Decision Quality&quot;,
    linewidth=2,
)</code></pre><img src="58b31e5b.svg" alt="Example block output"/><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorial/">« Basic Tutorial: Training with FYL on Argmax Benchmark</a><a class="docs-footer-nextpage" href="../../api/">API Reference »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 16 January 2026 16:07">Friday 16 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
