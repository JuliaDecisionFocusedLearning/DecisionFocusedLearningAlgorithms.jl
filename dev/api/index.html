<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · DecisionFocusedLearningAlgorithms.jl</title><meta name="title" content="API Reference · DecisionFocusedLearningAlgorithms.jl"/><meta property="og:title" content="API Reference · DecisionFocusedLearningAlgorithms.jl"/><meta property="twitter:title" content="API Reference · DecisionFocusedLearningAlgorithms.jl"/><meta name="description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><meta property="og:description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><meta property="twitter:description" content="Documentation for DecisionFocusedLearningAlgorithms.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">DecisionFocusedLearningAlgorithms.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../interface/">Interface Guide</a></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/tutorial/">Basic Tutorial: Training with FYL on Argmax Benchmark</a></li><li><a class="tocitem" href="../tutorials/warcraft_fyl/">Training on Warcraft Shortest Path</a></li></ul></li><li class="is-active"><a class="tocitem" href>API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/main/docs/src/api.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><ul><li><a href="#DecisionFocusedLearningAlgorithms.AbstractAlgorithm"><code>DecisionFocusedLearningAlgorithms.AbstractAlgorithm</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm"><code>DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.AbstractMetric"><code>DecisionFocusedLearningAlgorithms.AbstractMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.AbstractPolicy"><code>DecisionFocusedLearningAlgorithms.AbstractPolicy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.AnticipativeImitation"><code>DecisionFocusedLearningAlgorithms.AnticipativeImitation</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.DAgger"><code>DecisionFocusedLearningAlgorithms.DAgger</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.DFLPolicy-Tuple{AbstractArray}"><code>DecisionFocusedLearningAlgorithms.DFLPolicy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.DFLPolicy"><code>DecisionFocusedLearningAlgorithms.DFLPolicy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.FYLLossMetric"><code>DecisionFocusedLearningAlgorithms.FYLLossMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.FYLLossMetric"><code>DecisionFocusedLearningAlgorithms.FYLLossMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.FunctionMetric-Union{Tuple{F}, Tuple{F, Symbol}} where F"><code>DecisionFocusedLearningAlgorithms.FunctionMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.FunctionMetric"><code>DecisionFocusedLearningAlgorithms.FunctionMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>DecisionFocusedLearningAlgorithms.LossAccumulator</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>DecisionFocusedLearningAlgorithms.LossAccumulator</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.PeriodicMetric-Union{Tuple{M}, Tuple{M, Int64}} where M&lt;:AbstractMetric"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.PeriodicMetric"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.PeriodicMetric-Tuple{Any, Int64}"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.PerturbedFenchelYoungLossImitation"><code>DecisionFocusedLearningAlgorithms.PerturbedFenchelYoungLossImitation</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.TrainingContext"><code>DecisionFocusedLearningAlgorithms.TrainingContext</code></a></li><li><a href="#Base.getproperty-Tuple{PeriodicMetric, Symbol}"><code>Base.getproperty</code></a></li><li><a href="#Base.propertynames"><code>Base.propertynames</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Nothing}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Number}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, NamedTuple}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.compute!-Tuple{LossAccumulator}"><code>DecisionFocusedLearningAlgorithms.compute!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.compute!-Tuple{FYLLossMetric}"><code>DecisionFocusedLearningAlgorithms.compute!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FunctionMetric, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FYLLossMetric, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{PeriodicMetric, Any}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate_metrics!-Tuple{ValueHistories.MVHistory, Tuple, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate_metrics!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.next_epoch!-Tuple{TrainingContext}"><code>DecisionFocusedLearningAlgorithms.next_epoch!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.reset!-Tuple{FYLLossMetric}"><code>DecisionFocusedLearningAlgorithms.reset!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.reset!-Tuple{LossAccumulator}"><code>DecisionFocusedLearningAlgorithms.reset!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{DAgger, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{PerturbedFenchelYoungLossImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractBenchmark}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{AnticipativeImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, MLUtils.DataLoader}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, AbstractArray{&lt;:DecisionFocusedLearningBenchmarks.Utils.DataSample}}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{DAgger, DFLPolicy, Any}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{AnticipativeImitation, DFLPolicy, Any}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.update!-Tuple{LossAccumulator, Float64}"><code>DecisionFocusedLearningAlgorithms.update!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, InferOpt.FenchelYoungLoss, Any, Any}"><code>DecisionFocusedLearningAlgorithms.update!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, Float64}"><code>DecisionFocusedLearningAlgorithms.update!</code></a></li></ul><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.AbstractAlgorithm"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.AbstractAlgorithm"><code>DecisionFocusedLearningAlgorithms.AbstractAlgorithm</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractAlgorithm</code></pre><p>An abstract type for decision-focused learning algorithms.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/abstract_algorithm.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm"><code>DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractImitationAlgorithm &lt;: DecisionFocusedLearningAlgorithms.AbstractAlgorithm</code></pre><p>An abstract type for imitation learning algorithms.</p><p>All subtypes must implement:</p><ul><li><code>train_policy!(algorithm::AbstractImitationAlgorithm, model, maximizer, train_data; epochs, metrics)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/abstract_algorithm.jl#L8">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.AbstractMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.AbstractMetric"><code>DecisionFocusedLearningAlgorithms.AbstractMetric</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractMetric</code></pre><p>Abstract base type for all metrics used during training.</p><p>All concrete metric types should implement:</p><ul><li><code>evaluate!(metric, context)</code> - Evaluate the metric given a training context</li></ul><p><strong>See also</strong></p><ul><li><a href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>LossAccumulator</code></a></li><li><a href="../interface/#FYLLossMetric"><code>FYLLossMetric</code></a></li><li><a href="../interface/#FunctionMetric"><code>FunctionMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.PeriodicMetric"><code>PeriodicMetric</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.AbstractPolicy"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.AbstractPolicy"><code>DecisionFocusedLearningAlgorithms.AbstractPolicy</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">abstract type AbstractPolicy</code></pre><p>Abstract type for policies used in decision-focused learning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/policies/abstract_policy.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.AnticipativeImitation"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.AnticipativeImitation"><code>DecisionFocusedLearningAlgorithms.AnticipativeImitation</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct AnticipativeImitation{A} &lt;: DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm</code></pre><p>Anticipative Imitation algorithm for supervised learning using anticipative solutions.</p><p>Trains a policy in a single shot using expert demonstrations from anticipative solutions.</p><p>Reference: <a href="https://arxiv.org/abs/2304.00789">https://arxiv.org/abs/2304.00789</a></p><p><strong>Fields</strong></p><ul><li><code>inner_algorithm::Any</code>: inner imitation algorithm for supervised learning</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/anticipative_imitation.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.DAgger"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.DAgger"><code>DecisionFocusedLearningAlgorithms.DAgger</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct DAgger{A} &lt;: DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm</code></pre><p>Dataset Aggregation (DAgger) algorithm for imitation learning.</p><p>Reference: <a href="https://arxiv.org/abs/2402.04463">https://arxiv.org/abs/2402.04463</a></p><p><strong>Fields</strong></p><ul><li><p><code>inner_algorithm::Any</code>: inner imitation algorithm for supervised learning</p></li><li><p><code>iterations::Int64</code>: number of DAgger iterations</p></li><li><p><code>epochs_per_iteration::Int64</code>: number of epochs per DAgger iteration</p></li><li><p><code>α_decay::Float64</code>: decay factor for mixing expert and learned policy</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/dagger.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.DFLPolicy"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.DFLPolicy"><code>DecisionFocusedLearningAlgorithms.DFLPolicy</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct DFLPolicy{ML, CO} &lt;: AbstractPolicy</code></pre><p>Decision-Focused Learning Policy combining a machine learning model and a combinatorial optimizer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/policies/dfl_policy.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.DFLPolicy-Tuple{AbstractArray}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.DFLPolicy-Tuple{AbstractArray}"><code>DecisionFocusedLearningAlgorithms.DFLPolicy</code></a> — <span class="docstring-category">Method</span></summary><section><div><p>Run the policy and get the next decision on the given input features.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/policies/dfl_policy.jl#L13">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.FYLLossMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.FYLLossMetric"><code>DecisionFocusedLearningAlgorithms.FYLLossMetric</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct FYLLossMetric{D} &lt;: AbstractMetric</code></pre><p>Metric for evaluating Fenchel-Young Loss over a dataset.</p><p>This metric stores a dataset and computes the average Fenchel-Young Loss when <code>evaluate!</code> is called. Useful for tracking validation loss during training. Can also be used in the algorithms to accumulate loss over training data with <code>update!</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>dataset::Any</code>: dataset to evaluate on</p></li><li><p><code>accumulator::LossAccumulator</code>: accumulator for loss values</p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Create metric with validation dataset
val_metric = FYLLossMetric(val_dataset, :validation_loss)

# Evaluate during training (called by evaluate_metrics!)
context = TrainingContext(policy=policy, epoch=5, loss=loss)
avg_loss = evaluate!(val_metric, context)</code></pre><p><strong>See also</strong></p><ul><li><a href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>LossAccumulator</code></a></li><li><a href="../interface/#FunctionMetric"><code>FunctionMetric</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L115">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.FYLLossMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.FYLLossMetric"><code>DecisionFocusedLearningAlgorithms.FYLLossMetric</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">FYLLossMetric(dataset, name::Symbol=:fyl_loss)</code></pre><p>Construct a FYLLossMetric for a given dataset.</p><p><strong>Arguments</strong></p><ul><li><code>dataset</code> - Dataset to evaluate on (should have samples with <code>.x</code>, <code>.y</code>, and <code>.info</code> fields)</li><li><code>name::Symbol</code> - Identifier for the metric (default: <code>:fyl_loss</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L148-L156">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.FunctionMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.FunctionMetric"><code>DecisionFocusedLearningAlgorithms.FunctionMetric</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct FunctionMetric{F, D} &lt;: AbstractMetric</code></pre><p>A flexible metric that wraps a user-defined function.</p><p>This metric allows users to define custom metrics using functions. The function receives the training context and optionally any stored data. It can return:</p><ul><li>A single value (stored with <code>metric.name</code>)</li><li>A <code>NamedTuple</code> (each key-value pair stored separately)</li></ul><p><strong>Fields</strong></p><ul><li><p><code>metric_fn::Any</code>: function with signature <code>(context) -&gt; value</code> or <code>(context, data) -&gt; value</code></p></li><li><p><code>name::Symbol</code>: identifier for the metric</p></li><li><p><code>data::Any</code>: optional data stored in the metric (default: <code>nothing</code>)</p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Simple metric using only context
epoch_metric = FunctionMetric(ctx -&gt; ctx.epoch, :current_epoch)

# Metric with stored data (dataset)
gap_metric = FunctionMetric(:val_gap, val_data) do ctx, data
    compute_gap(benchmark, data, ctx.model, ctx.maximizer)
end

# Metric returning multiple values
dual_gap = FunctionMetric(:gaps, (train_data, val_data)) do ctx, datasets
    train_ds, val_ds = datasets
    return (
        train_gap = compute_gap(benchmark, train_ds, ctx.model, ctx.maximizer),
        val_gap = compute_gap(benchmark, val_ds, ctx.model, ctx.maximizer)
    )
end</code></pre><p><strong>See also</strong></p><ul><li><a href="#DecisionFocusedLearningAlgorithms.PeriodicMetric"><code>PeriodicMetric</code></a> - Wrap a metric to evaluate periodically</li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!"><code>evaluate!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/function_metric.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.FunctionMetric-Union{Tuple{F}, Tuple{F, Symbol}} where F"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.FunctionMetric-Union{Tuple{F}, Tuple{F, Symbol}} where F"><code>DecisionFocusedLearningAlgorithms.FunctionMetric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">FunctionMetric(
    metric_fn,
    name::Symbol
) -&gt; FunctionMetric{_A, Nothing} where _A
</code></pre><p>Construct a FunctionMetric without stored data.</p><p>The function should have signature <code>(context) -&gt; value</code>.</p><p><strong>Arguments</strong></p><ul><li><code>metric_fn::Function</code> - Function to compute the metric</li><li><code>name::Symbol</code> - Identifier for the metric</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/function_metric.jl#L47">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.LossAccumulator"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>DecisionFocusedLearningAlgorithms.LossAccumulator</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">LossAccumulator() -&gt; LossAccumulator
LossAccumulator(name::Symbol) -&gt; LossAccumulator
</code></pre><p>Construct a LossAccumulator with the given name. Initializes total loss and count to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L41">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.LossAccumulator"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.LossAccumulator"><code>DecisionFocusedLearningAlgorithms.LossAccumulator</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">mutable struct LossAccumulator</code></pre><p>Accumulates loss values during training and computes their average.</p><p>This metric is used internally by training loops to track training loss. It accumulates loss values via <code>update!</code> calls and computes the average via <code>compute!</code>.</p><p><strong>Fields</strong></p><ul><li><p><code>name::Symbol</code></p></li><li><p><code>total_loss::Float64</code>: Running sum of loss values</p></li><li><p><code>count::Int64</code>: Number of samples accumulated</p></li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">metric = LossAccumulator(:training_loss)

# During training
for sample in dataset
    loss_value = compute_loss(model, sample)
    update!(metric, loss_value)
end

# Get average and reset
avg_loss = compute!(metric)  # Automatically resets</code></pre><p><strong>See also</strong></p><ul><li><a href="../interface/#FYLLossMetric"><code>FYLLossMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.reset!-Tuple{FYLLossMetric}"><code>reset!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, Float64}"><code>update!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.compute!-Tuple{FYLLossMetric}"><code>compute!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.PeriodicMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.PeriodicMetric"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct PeriodicMetric{M&lt;:AbstractMetric} &lt;: AbstractMetric</code></pre><p>Wrapper that evaluates a metric only every N epochs.</p><p>This is useful for expensive metrics that don&#39;t need to be computed every epoch (e.g., gap computation, test set evaluation).</p><p><strong>Fields</strong></p><ul><li><p><code>metric::AbstractMetric</code>: the wrapped metric to evaluate periodically</p></li><li><p><code>frequency::Int64</code>: evaluate every N epochs</p></li><li><p><code>offset::Int64</code>: offset for the first evaluation</p></li></ul><p><strong>Behavior</strong></p><p>The metric is evaluated when <code>(epoch - offset) % frequency == 0</code>. On other epochs, <code>evaluate!</code> returns <code>nothing</code> (which is skipped by <code>evaluate_metrics!</code>).</p><p><strong>See also</strong></p><ul><li><a href="../interface/#FunctionMetric"><code>FunctionMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!"><code>evaluate!</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate_metrics!-Tuple{ValueHistories.MVHistory, Tuple, TrainingContext}"><code>evaluate_metrics!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.PeriodicMetric-Tuple{Any, Int64}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.PeriodicMetric-Tuple{Any, Int64}"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">PeriodicMetric(
    metric_fn,
    frequency::Int64;
    offset
) -&gt; PeriodicMetric
</code></pre><p>Construct a PeriodicMetric from a function to be wrapped.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L39">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.PeriodicMetric-Union{Tuple{M}, Tuple{M, Int64}} where M&lt;:AbstractMetric"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.PeriodicMetric-Union{Tuple{M}, Tuple{M, Int64}} where M&lt;:AbstractMetric"><code>DecisionFocusedLearningAlgorithms.PeriodicMetric</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">PeriodicMetric(
    metric::AbstractMetric,
    frequency::Int64;
    offset
) -&gt; PeriodicMetric
</code></pre><p>Construct a PeriodicMetric that evaluates the wrapped metric every N epochs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L30">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.PerturbedFenchelYoungLossImitation"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.PerturbedFenchelYoungLossImitation"><code>DecisionFocusedLearningAlgorithms.PerturbedFenchelYoungLossImitation</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">struct PerturbedFenchelYoungLossImitation{O, S} &lt;: DecisionFocusedLearningAlgorithms.AbstractImitationAlgorithm</code></pre><p>Structured imitation learning with a perturbed Fenchel-Young loss.</p><p>Reference: <a href="https://arxiv.org/abs/2002.08676">https://arxiv.org/abs/2002.08676</a></p><p><strong>Fields</strong></p><ul><li><p><code>nb_samples::Int64</code>: number of perturbation samples</p></li><li><p><code>ε::Float64</code>: perturbation magnitude</p></li><li><p><code>threaded::Bool</code>: whether to use threading for perturbations</p></li><li><p><code>training_optimizer::Any</code>: optimizer used for training</p></li><li><p><code>seed::Any</code>: random seed for perturbations</p></li><li><p><code>use_multiplicative_perturbation::Bool</code>: whether to use multiplicative perturbation (else additive)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/fyl.jl#L6">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.TrainingContext"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.TrainingContext"><code>DecisionFocusedLearningAlgorithms.TrainingContext</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">mutable struct TrainingContext{P, F, O&lt;:NamedTuple}</code></pre><p>Lightweight mutable context object passed to metrics during training.</p><p><strong>Fields</strong></p><ul><li><p><code>policy::Any</code></p></li><li><p><code>epoch::Int64</code>: current epoch number (mutated in-place during training)</p></li><li><p><code>maximizer_kwargs::Any</code></p></li><li><p><code>other_fields::NamedTuple</code></p></li></ul><p><strong>Notes</strong></p><ul><li><code>policy</code>, <code>maximizer_kwargs</code>, and <code>other_fields</code> are constant after construction; only <code>epoch</code> is intended to be mutated.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/training_context.jl#L1">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Base.getproperty-Tuple{PeriodicMetric, Symbol}"><a class="docstring-binding" href="#Base.getproperty-Tuple{PeriodicMetric, Symbol}"><code>Base.getproperty</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">getproperty(pm::PeriodicMetric, s::Symbol) -&gt; Any
</code></pre><p>Delegate <code>name</code> property to the wrapped metric for seamless integration.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L49">source</a></section></details></article><article><details class="docstring" open="true"><summary id="Base.propertynames"><a class="docstring-binding" href="#Base.propertynames"><code>Base.propertynames</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">propertynames(pm::PeriodicMetric) -&gt; NTuple{4, Symbol}
propertynames(
    pm::PeriodicMetric,
    private::Bool
) -&gt; NTuple{4, Symbol}
</code></pre><p>List available properties of PeriodicMetric.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L62">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, NamedTuple}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, NamedTuple}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_store_metric_value!(
    history::ValueHistories.MVHistory,
    _::Symbol,
    epoch::Int64,
    value::NamedTuple
)
</code></pre><p>Internal helper to store multiple metric values from a NamedTuple. Each key-value pair is stored separately in the history.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L58">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Nothing}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Nothing}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_store_metric_value!(
    _::ValueHistories.MVHistory,
    _::Symbol,
    _::Int64,
    _::Nothing
)
</code></pre><p>Internal helper that skips storing when value is <code>nothing</code>. Used by periodic metrics on epochs when they&#39;re not evaluated.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Number}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms._store_metric_value!-Tuple{ValueHistories.MVHistory, Symbol, Int64, Number}"><code>DecisionFocusedLearningAlgorithms._store_metric_value!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">_store_metric_value!(
    history::ValueHistories.MVHistory,
    metric_name::Symbol,
    epoch::Int64,
    value::Number
)
</code></pre><p>Internal helper to store a single metric value in the history.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L38">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.compute!-Tuple{FYLLossMetric}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.compute!-Tuple{FYLLossMetric}"><code>DecisionFocusedLearningAlgorithms.compute!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute!(metric::FYLLossMetric) -&gt; Float64
</code></pre><p>Compute the average loss from accumulated values.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L229">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.compute!-Tuple{LossAccumulator}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.compute!-Tuple{LossAccumulator}"><code>DecisionFocusedLearningAlgorithms.compute!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">compute!(metric::LossAccumulator; reset) -&gt; Float64
</code></pre><p>Compute the average loss from accumulated values.</p><p><strong>Arguments</strong></p><ul><li><code>metric::LossAccumulator</code> - The accumulator to compute from</li><li><code>reset::Bool</code> - Whether to reset the accumulator after computing (default: <code>true</code>)</li></ul><p><strong>Returns</strong></p><ul><li><code>Float64</code> - Average loss (or 0.0 if no values accumulated)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs">metric = LossAccumulator()
update!(metric, 1.5)
update!(metric, 2.5)
avg = compute!(metric)  # Returns 2.0, then resets</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L87">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.evaluate!"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.evaluate!"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(metric::AbstractMetric, context::TrainingContext)</code></pre><p>Evaluate the metric given the current training context.</p><p><strong>Arguments</strong></p><ul><li><code>metric::AbstractMetric</code> - The metric to evaluate</li><li><code>context::TrainingContext</code> - Current training state (model, epoch, maximizer, etc.)</li></ul><p><strong>Returns</strong></p><p>Can return:</p><ul><li>A single value (Float64, Int, etc.) - stored with <code>metric.name</code></li><li>A <code>NamedTuple</code> - each key-value pair stored separately</li><li><code>nothing</code> - skipped (e.g., periodic metrics on off-epochs)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L17-L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FYLLossMetric, TrainingContext}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FYLLossMetric, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(
    metric::FYLLossMetric,
    context::TrainingContext
) -&gt; Float64
</code></pre><p>Evaluate the average Fenchel-Young Loss over the stored dataset.</p><p>This method iterates through the dataset, computes predictions using <code>context.policy</code>, and accumulates losses using <code>context.loss</code>. The dataset should be stored in the metric.</p><p><strong>Arguments</strong></p><ul><li><code>metric::FYLLossMetric</code> - The metric to evaluate</li><li><code>context</code> - TrainingContext with <code>policy</code>, <code>loss</code>, and other fields</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L196">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FunctionMetric, TrainingContext}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{FunctionMetric, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(
    metric::FunctionMetric,
    context::TrainingContext
) -&gt; Any
</code></pre><p>Evaluate the function metric by calling the stored function.</p><p><strong>Arguments</strong></p><ul><li><code>metric::FunctionMetric</code> - The metric to evaluate</li><li><code>context</code> - TrainingContext with current training state</li></ul><p><strong>Returns</strong></p><ul><li>The value returned by <code>metric.metric_fn</code> (can be single value or NamedTuple)</li></ul><p>```</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/function_metric.jl#L62">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.evaluate!-Tuple{PeriodicMetric, Any}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.evaluate!-Tuple{PeriodicMetric, Any}"><code>DecisionFocusedLearningAlgorithms.evaluate!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate!(pm::PeriodicMetric, context) -&gt; Any
</code></pre><p>Evaluate the wrapped metric only if the current epoch matches the frequency pattern.</p><p><strong>Arguments</strong></p><ul><li><code>pm::PeriodicMetric</code> - The periodic metric wrapper</li><li><code>context</code> - TrainingContext with current epoch</li></ul><p><strong>Returns</strong></p><ul><li>The result of <code>evaluate!(pm.metric, context)</code> if epoch matches the pattern</li><li><code>nothing</code> otherwise (which is skipped by <code>evaluate_metrics!</code>)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/periodic.jl#L71">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.evaluate_metrics!-Tuple{ValueHistories.MVHistory, Tuple, TrainingContext}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.evaluate_metrics!-Tuple{ValueHistories.MVHistory, Tuple, TrainingContext}"><code>DecisionFocusedLearningAlgorithms.evaluate_metrics!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">evaluate_metrics!(
    history::ValueHistories.MVHistory,
    metrics::Tuple,
    context::TrainingContext
)
</code></pre><p>Evaluate all metrics and store their results in the history.</p><p>This function handles three types of metric returns through multiple dispatch:</p><ul><li><strong>Single value</strong>: Stored with the metric&#39;s name</li><li><strong>NamedTuple</strong>: Each key-value pair stored separately (for metrics that compute multiple values)</li><li><strong>nothing</strong>: Skipped (e.g., periodic metrics on epochs when not evaluated)</li></ul><p><strong>Arguments</strong></p><ul><li><code>history::MVHistory</code> - MVHistory object to store metric values</li><li><code>metrics::Tuple</code> - Tuple of AbstractMetric instances to evaluate</li><li><code>context::TrainingContext</code> - TrainingContext with current training state (policy, epoch, etc.)</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia hljs"># Create metrics
val_loss = FYLLossMetric(val_dataset, :validation_loss)
epoch_metric = FunctionMetric(ctx -&gt; ctx.epoch, :current_epoch)

# Evaluate and store
context = TrainingContext(policy=policy, epoch=5)
evaluate_metrics!(history, (val_loss, epoch_metric), context)</code></pre><p><strong>See also</strong></p><ul><li><a href="#DecisionFocusedLearningAlgorithms.AbstractMetric"><code>AbstractMetric</code></a></li><li><a href="#DecisionFocusedLearningAlgorithms.evaluate!"><code>evaluate!</code></a></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/interface.jl#L81">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.next_epoch!-Tuple{TrainingContext}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.next_epoch!-Tuple{TrainingContext}"><code>DecisionFocusedLearningAlgorithms.next_epoch!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">next_epoch!(ctx::TrainingContext)
</code></pre><p>Advance the epoch counter in the training context by one.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/training_context.jl#L57">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.reset!-Tuple{FYLLossMetric}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.reset!-Tuple{FYLLossMetric}"><code>DecisionFocusedLearningAlgorithms.reset!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">reset!(metric::FYLLossMetric) -&gt; Int64
</code></pre><p>Reset the metric&#39;s accumulated loss to zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L161">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.reset!-Tuple{LossAccumulator}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.reset!-Tuple{LossAccumulator}"><code>DecisionFocusedLearningAlgorithms.reset!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">reset!(metric::LossAccumulator) -&gt; Int64
</code></pre><p>Reset the accumulator to its initial state (zero total loss and count).</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">metric = LossAccumulator()
update!(metric, 1.5)
update!(metric, 2.0)
reset!(metric)  # total_loss = 0.0, count = 0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L51">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy!-Tuple{AnticipativeImitation, DFLPolicy, Any}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{AnticipativeImitation, DFLPolicy, Any}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy!(
    algorithm::AnticipativeImitation,
    policy::DFLPolicy,
    train_environments;
    anticipative_policy,
    epochs,
    metrics,
    maximizer_kwargs
)
</code></pre><p>Train a DFLPolicy using the Anticipative Imitation algorithm on provided training environments.</p><p><strong>Core training method</strong></p><p>Generates anticipative solutions from environments and trains the policy using supervised learning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/anticipative_imitation.jl#L18">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy!-Tuple{DAgger, DFLPolicy, Any}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{DAgger, DFLPolicy, Any}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy!(
    algorithm::DAgger,
    policy::DFLPolicy,
    train_environments;
    anticipative_policy,
    metrics,
    maximizer_kwargs
)
</code></pre><p>Train a DFLPolicy using the DAgger algorithm on the provided training environments.</p><p><strong>Core training method</strong></p><p>Requires <code>train_environments</code> and <code>anticipative_policy</code> as keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/dagger.jl#L22">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, AbstractArray{&lt;:DecisionFocusedLearningBenchmarks.Utils.DataSample}}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, AbstractArray{&lt;:DecisionFocusedLearningBenchmarks.Utils.DataSample}}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy!(
    algorithm::PerturbedFenchelYoungLossImitation,
    policy::DFLPolicy,
    train_dataset::AbstractArray{&lt;:DecisionFocusedLearningBenchmarks.Utils.DataSample};
    epochs,
    metrics,
    maximizer_kwargs
) -&gt; ValueHistories.MVHistory{ValueHistories.History}
</code></pre><p>Train a DFLPolicy using the Perturbed Fenchel-Young Loss Imitation Algorithm with unbatched data.</p><p>This convenience method wraps the dataset in a <code>DataLoader</code> with batchsize=1 and delegates  to the batched training method. For custom batching behavior, create your own <code>DataLoader</code>  and use the batched method directly.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/fyl.jl#L94">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, MLUtils.DataLoader}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy!-Tuple{PerturbedFenchelYoungLossImitation, DFLPolicy, MLUtils.DataLoader}"><code>DecisionFocusedLearningAlgorithms.train_policy!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy!(
    algorithm::PerturbedFenchelYoungLossImitation,
    policy::DFLPolicy,
    train_dataset::MLUtils.DataLoader;
    epochs,
    metrics,
    maximizer_kwargs
) -&gt; ValueHistories.MVHistory{ValueHistories.History}
</code></pre><p>Train a DFLPolicy using the Perturbed Fenchel-Young Loss Imitation Algorithm.</p><p>The <code>train_dataset</code> should be a <code>DataLoader</code> for batched training. Gradients are computed  from the sum of losses across each batch before updating model parameters.</p><p>For unbatched training with a <code>Vector{DataSample}</code>, use the convenience method that  automatically wraps the data in a DataLoader with batchsize=1.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/fyl.jl#L31">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy-Tuple{AnticipativeImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{AnticipativeImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy(
    algorithm::AnticipativeImitation,
    benchmark::DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true};
    dataset_size,
    split_ratio,
    epochs,
    metrics,
    seed
) -&gt; Tuple{Any, DFLPolicy}
</code></pre><p>Train a DFLPolicy using the Anticipative Imitation algorithm on a benchmark.</p><p><strong>Benchmark convenience wrapper</strong></p><p>This high-level function handles all setup from the benchmark and returns a trained policy. Uses anticipative solutions as expert demonstrations.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/anticipative_imitation.jl#L53">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy-Tuple{DAgger, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{DAgger, DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true}}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy(
    algorithm::DAgger,
    benchmark::DecisionFocusedLearningBenchmarks.Utils.AbstractStochasticBenchmark{true};
    dataset_size,
    split_ratio,
    metrics,
    seed
) -&gt; Tuple{ValueHistories.MVHistory{ValueHistories.History}, DFLPolicy}
</code></pre><p>Train a DFLPolicy using the DAgger algorithm on a benchmark.</p><p><strong>Benchmark convenience wrapper</strong></p><p>This high-level function handles all setup from the benchmark and returns a trained policy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/dagger.jl#L141">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.train_policy-Tuple{PerturbedFenchelYoungLossImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractBenchmark}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.train_policy-Tuple{PerturbedFenchelYoungLossImitation, DecisionFocusedLearningBenchmarks.Utils.AbstractBenchmark}"><code>DecisionFocusedLearningAlgorithms.train_policy</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">train_policy(
    algorithm::PerturbedFenchelYoungLossImitation,
    benchmark::DecisionFocusedLearningBenchmarks.Utils.AbstractBenchmark;
    dataset_size,
    split_ratio,
    epochs,
    metrics,
    seed
) -&gt; Tuple{ValueHistories.MVHistory{ValueHistories.History}, DFLPolicy}
</code></pre><p>Train a DFLPolicy using the Perturbed Fenchel-Young Loss Imitation Algorithm on a benchmark.</p><p><strong>Benchmark convenience wrapper</strong></p><p>This high-level function handles all setup from the benchmark and returns a trained policy.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/algorithms/supervised/fyl.jl#L122">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, Float64}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, Float64}"><code>DecisionFocusedLearningAlgorithms.update!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">update!(
    metric::FYLLossMetric,
    loss_value::Float64
) -&gt; Float64
</code></pre><p>Update the metric with an already-computed loss value. This avoids re-evaluating the loss inside the metric when the loss was computed during training.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L218">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, InferOpt.FenchelYoungLoss, Any, Any}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.update!-Tuple{FYLLossMetric, InferOpt.FenchelYoungLoss, Any, Any}"><code>DecisionFocusedLearningAlgorithms.update!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">update!(
    metric::FYLLossMetric,
    loss::InferOpt.FenchelYoungLoss,
    θ,
    y_target;
    kwargs...
) -&gt; Any
</code></pre><p>Update the metric with a single loss computation.</p><p><strong>Arguments</strong></p><ul><li><code>metric::FYLLossMetric</code> - The metric to update</li><li><code>loss::FenchelYoungLoss</code> - Loss function to use</li><li><code>θ</code> - Model prediction</li><li><code>y_target</code> - Target value</li><li><code>kwargs...</code> - Additional arguments passed to loss function</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L178">source</a></section></details></article><article><details class="docstring" open="true"><summary id="DecisionFocusedLearningAlgorithms.update!-Tuple{LossAccumulator, Float64}"><a class="docstring-binding" href="#DecisionFocusedLearningAlgorithms.update!-Tuple{LossAccumulator, Float64}"><code>DecisionFocusedLearningAlgorithms.update!</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">update!(
    metric::LossAccumulator,
    loss_value::Float64
) -&gt; Int64
</code></pre><p>Add a loss value to the accumulator.</p><p><strong>Examples</strong></p><pre><code class="language-julia hljs">metric = LossAccumulator()
update!(metric, 1.5)
update!(metric, 2.0)
compute!(metric)  # Returns 1.75</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaDecisionFocusedLearning/DecisionFocusedLearningAlgorithms.jl/blob/13d239854bda129af9967e75e8c21987234743f0/src/metrics/accumulators.jl#L69">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../tutorials/warcraft_fyl/">« Training on Warcraft Shortest Path</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 16 January 2026 16:07">Friday 16 January 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
